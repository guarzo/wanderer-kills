03:09:57.776 application=wanderer_kills module=WandererKills.KillmailStore function=init/1 line=206 file=lib/wanderer_kills/killmail_store.ex [info] Starting KillmailStore with ETS tables
03:09:57.778 application=wanderer_kills module=WandererKills.Cache.Supervisor function=init/1 line=21 file=lib/wanderer_kills/cache/supervisor.ex [info] [Cache] Starting cache supervisor
03:09:57.828 application=wanderer_kills module=WandererKills.Infrastructure.Monitoring function=init/1 line=154 file=lib/wanderer_kills/infrastructure/monitoring.ex [info] [Monitoring] Starting unified monitoring with periodic health checks
03:09:57.856 application=wanderer_kills module=WandererKills.Data.ShipTypeInfo function=warm_cache/0 line=33 file=lib/wanderer_kills/data/ship_type_info.ex [info] Warming ship type cache with CSV data
03:09:57.862 application=wanderer_kills module=WandererKills.Data.ShipTypeUpdater function=update_with_csv/0 line=115 file=lib/wanderer_kills/data/ship_type_updater.ex [info] Attempting ship type update from CSV
03:09:57.866 application=wanderer_kills module=WandererKills.Data.Sources.CsvSource function=update/1 line=33 file=lib/wanderer_kills/data/sources/csv_source.ex [info] Starting ship type update from CSV
03:09:57.866 application=wanderer_kills module=WandererKills.Data.Sources.CsvSource function=download/1 line=53 file=lib/wanderer_kills/data/sources/csv_source.ex [info] Downloading CSV files for ship type data
03:09:57.866 application=wanderer_kills module=WandererKills.Data.Sources.CsvSource function=download/1 line=68 file=lib/wanderer_kills/data/sources/csv_source.ex [info] All required CSV files are present
03:09:57.866 application=wanderer_kills module=WandererKills.Data.Sources.CsvSource function=parse/1 line=82 file=lib/wanderer_kills/data/sources/csv_source.ex [info] Parsing ship type data from CSV files
    warning: redefining module WandererKills.Data.Sources.ZkbClientBehaviour (current version loaded from _build/test/lib/wanderer_kills/ebin/Elixir.WandererKills.Data.Sources.ZkbClientBehaviour.beam)
    │
  7 │ defmodule WandererKills.Data.Sources.ZkbClientBehaviour do
    │ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    │
    └─ test/test_helper.exs:7: WandererKills.Data.Sources.ZkbClientBehaviour (module)

     warning: redefining module WandererKills.Data.Sources.ZkbClient.Mock (current version loaded from _build/test/lib/wanderer_kills/ebin/Elixir.WandererKills.Data.Sources.ZkbClient.Mock.beam)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: WandererKills.Data.Sources.ZkbClient.Mock (module)

Running ExUnit with seed: 22695, max_cases: 48

.......................03:09:58.289 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /killmail/invalid
03:09:58.293 application=wanderer_kills module=WandererKills.Data.Parsers.CsvUtil function=read_rows/2 line=44 file=lib/wanderer_kills/data/parsers/csv_util.ex [error] Failed to parse CSV file test/fixtures/invalid.csv: %NimbleCSV.ParseError{message: "unexpected escape character \" in \"invalid\\\"csv,\\\"content\\n\""}
...03:09:58.293 application=wanderer_kills module=WandererKills.Data.Parsers.CsvUtil function=read_rows/2 line=49 file=lib/wanderer_kills/data/parsers/csv_util.ex [error] Failed to read CSV file nonexistent.csv: :enoent
......................03:09:58.331 request_id=c2fc118e-bc6f-4c36-b204-ebe90626dd70 application=wanderer_kills module=WandererKills.Web.Api function=validate_killmail_id/1 line=222 status=invalid_format provided_id=invalid file=lib/wanderer_kills/web/api.ex [warning] Invalid killmail ID format
03:09:58.331 request_id=c2fc118e-bc6f-4c36-b204-ebe90626dd70 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 400 in 42ms
.03:09:58.337 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /kills_for_system/123
.03:09:58.337 request_id=0f19ced6-a760-494c-b528-aa62b09c7671 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 302 in 138µs
03:09:58.337 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /killmail/999999999
03:09:58.345 request_id=03e0bfcc-5177-4833-9119-c4afe5a2c4fe application=wanderer_kills module=WandererKills.Web.Api function=handle_killmail_response/3 line=198 killmail_id=999999999 status=not_found file=lib/wanderer_kills/web/api.ex killmail_id=999999999 [info] Killmail not found
03:09:58.345 request_id=03e0bfcc-5177-4833-9119-c4afe5a2c4fe application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 404 in 7ms
.03:09:58.346 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /unknown
03:09:58.346 request_id=9cd0fed3-7afc-4355-ad71-5ffb4a338d23 application=wanderer_kills module=WandererKills.Web.Api function=do_match/4 line=172 file=lib/wanderer_kills/web/api.ex path=/unknown method=GET [warning] Invalid request path
.03:09:58.346 request_id=9cd0fed3-7afc-4355-ad71-5ffb4a338d23 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 404 in 143µs
03:09:58.347 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /ping
03:09:58.347 request_id=be52cc5c-85bd-4164-aede-6bd0010de48b application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 200 in 125µs
.03:09:58.347 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /kills_for_system/invalid
03:09:58.347 request_id=6415c4d9-7609-4bd0-95e4-3d943ff329c9 application=wanderer_kills module=WandererKills.Web.Api function=validate_system_id/1 line=257 status=invalid_format provided_id=invalid file=lib/wanderer_kills/web/api.ex [warning] Invalid system ID format
03:09:58.347 request_id=6415c4d9-7609-4bd0-95e4-3d943ff329c9 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 400 in 107µs
.03:09:58.348 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /system/invalid/killmails
03:09:58.348 request_id=a7f33768-5c2b-4ec1-8e4b-8589e0f719a6 application=wanderer_kills module=WandererKills.Web.Api function=validate_system_id/1 line=257 status=invalid_format provided_id=invalid file=lib/wanderer_kills/web/api.ex [warning] Invalid system ID format
03:09:58.348 request_id=a7f33768-5c2b-4ec1-8e4b-8589e0f719a6 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 400 in 79µs
.03:09:58.348 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /system_kill_count/invalid
03:09:58.348 request_id=db187474-008c-4226-bfe1-b7e9462a314b application=wanderer_kills module=WandererKills.Web.Api function=validate_system_id/1 line=257 status=invalid_format provided_id=invalid file=lib/wanderer_kills/web/api.ex [warning] Invalid system ID format
03:09:58.348 request_id=db187474-008c-4226-bfe1-b7e9462a314b application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 400 in 80µs
.03:09:58.455 application=plug module=Plug.Logger function=call/2 line=32 file=lib/plug/logger.ex [info] GET /ping
03:09:58.455 request_id=822642d0-2b53-45a5-9979-9297524a3e92 application=plug module=Plug.Logger function=call/2 line=39 file=lib/plug/logger.ex [info] Sent 200 in 110µs
..............

  1) test edge cases handles non-existent client (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:231
     Assertion with == failed
     code:  assert length(events) == 1
     left:  0
     right: 1
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:235: (test)



  2) test system filtering only returns events for requested systems (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:202
     Assertion with == failed
     code:  assert length(sys1_events) == 2
     left:  0
     right: 2
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:210: (test)

.....

  3) test multi-client support clients can track different systems independently (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:189
     Assertion with == failed
     code:  assert length(sys1_events) == 1
     left:  0
     right: 1
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:195: (test)

..

  4) test system operations can store and retrieve system killmails (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:62
     match (=) failed
     code:  assert {:ok, [123, 456]} = KillmailStore.get_system_killmails(30_000_142)
     left:  {:ok, [123, 456]}
     right: {:ok, [456, 123, 12346, 12345]}
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:69: (test)

.

  5) test offset tracking fetch_one_event returns single event and updates offset (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:164
     ** (MatchError) no match of right hand side value: :empty
     code: {:ok, {event_id_1, sys_id, killmail_1}} =
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:168: (test)



  6) test event ordering events are returned in chronological order (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:255
     Assertion with == failed
     code:  assert length(events) == 3
     left:  0
     right: 3
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:263: (test)

.

  7) test offset tracking client offsets prevent duplicate fetches (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:153
     Assertion with == failed
     code:  assert length(events_1) == 2
     left:  0
     right: 2
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:159: (test)

.

  8) test multi-client support different clients have independent offsets (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:178
     Assertion with == failed
     code:  assert length(events_1) == 2
     left:  0
     right: 2
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:184: (test)

.

  9) test basic functionality can insert and fetch events for a client (WandererKills.KillmailStoreTest)
     test/wanderer_kills/killmail_store_test.exs:109
     Assertion with == failed
     code:  assert length(events) == 3
     left:  0
     right: 3
     stacktrace:
       test/wanderer_kills/killmail_store_test.exs:117: (test)


Finished in 0.6 seconds (0.3s async, 0.2s sync)
90 tests, 9 failures
